# NOTE: We define a number of tests where the *match* kind is 'leftmost-first'
# but the *search* kind is 'overlapping'. This is a somewhat nonsensical
# combination and can produce odd results. Nevertheless, those results should
# be consistent so we test them here. (At the time of writing this note, I
# hadn't yet decided whether to make 'leftmost-first' with 'overlapping' result
# in unspecified behavior.)

# This demonstrates how a full overlapping search is obvious quadratic. This
# regex reports a match for every substring in the haystack.
[[tests]]
name = "ungreedy-dotstar-matches-everything-100"
regexes = [".*?"]
haystack = "zzz"
matches = [
  { id = 0, span = [0, 0] },
  { id = 0, span = [1, 1] },
  { id = 0, span = [0, 1] },
  { id = 0, span = [2, 2] },
  { id = 0, span = [1, 2] },
  { id = 0, span = [0, 2] },
  { id = 0, span = [3, 3] },
  { id = 0, span = [2, 3] },
  { id = 0, span = [1, 3] },
  { id = 0, span = [0, 3] },
]
match_kind = "all"
search_kind = "overlapping"

[[tests]]
name = "greedy-dotstar-matches-everything-100"
regexes = [".*"]
haystack = "zzz"
matches = [
  { id = 0, span = [0, 0] },
  { id = 0, span = [1, 1] },
  { id = 0, span = [0, 1] },
  { id = 0, span = [2, 2] },
  { id = 0, span = [1, 2] },
  { id = 0, span = [0, 2] },
  { id = 0, span = [3, 3] },
  { id = 0, span = [2, 3] },
  { id = 0, span = [1, 3] },
  { id = 0, span = [0, 3] },
]
match_kind = "all"
search_kind = "overlapping"

[[tests]]
name = "repetition-plus-leftmost-first-100"
regex = 'a+'
haystack = "aaa"
matches = [[0, 1], [1, 2], [0, 2], [2, 3], [1, 3], [0, 3]]
match_kind = "leftmost-first"
search_kind = "overlapping"

[[tests]]
name = "repetition-plus-leftmost-first-110"
regex = '☃+'
haystack = "☃☃☃"
matches = [[0, 3], [3, 6], [0, 6], [6, 9], [3, 9], [0, 9]]
match_kind = "leftmost-first"
search_kind = "overlapping"

[[tests]]
name = "repetition-plus-all-100"
regex = 'a+'
haystack = "aaa"
matches = [[0, 1], [1, 2], [0, 2], [2, 3], [1, 3], [0, 3]]
match_kind = "all"
search_kind = "overlapping"

[[tests]]
name = "repetition-plus-all-110"
regex = '☃+'
haystack = "☃☃☃"
matches = [[0, 3], [3, 6], [0, 6], [6, 9], [3, 9], [0, 9]]
match_kind = "all"
search_kind = "overlapping"

[[tests]]
name = "repetition-plus-leftmost-first-200"
regex = '(abc)+'
haystack = "zzabcabczzabc"
matches = [
  [[2, 5], [2, 5]],
  [[5, 8], [5, 8]],
  [[2, 8], [5, 8]],
]
match_kind = "leftmost-first"
search_kind = "overlapping"

[[tests]]
name = "repetition-plus-all-200"
regex = '(abc)+'
haystack = "zzabcabczzabc"
matches = [
  [[2, 5], [2, 5]],
  [[5, 8], [5, 8]],
  [[2, 8], [5, 8]],
  [[10, 13], [10, 13]],
]
match_kind = "all"
search_kind = "overlapping"

[[tests]]
name = "repetition-star-leftmost-first-100"
regex = 'a*'
haystack = "aaa"
matches = [
  [0, 0],
  [1, 1],
  [0, 1],
  [2, 2],
  [1, 2],
  [0, 2],
  [3, 3],
  [2, 3],
  [1, 3],
  [0, 3],
]
match_kind = "leftmost-first"
search_kind = "overlapping"

[[tests]]
name = "repetition-star-all-100"
regex = 'a*'
haystack = "aaa"
matches = [
  [0, 0],
  [1, 1],
  [0, 1],
  [2, 2],
  [1, 2],
  [0, 2],
  [3, 3],
  [2, 3],
  [1, 3],
  [0, 3],
]
match_kind = "all"
search_kind = "overlapping"

[[tests]]
name = "repetition-star-leftmost-first-200"
regex = '(abc)*'
haystack = "zzabcabczzabc"
matches = [
  [[0, 0], []],
]
match_kind = "leftmost-first"
search_kind = "overlapping"

[[tests]]
name = "repetition-star-all-200"
regex = '(abc)*'
haystack = "zzabcabczzabc"
matches = [
  [[0, 0], []],
  [[1, 1], []],
  [[2, 2], []],
  [[3, 3], []],
  [[4, 4], []],
  [[5, 5], []],
  [[2, 5], [2, 5]],
  [[6, 6], []],
  [[7, 7], []],
  [[8, 8], []],
  [[5, 8], [5, 8]],
  [[2, 8], [5, 8]],
  [[9, 9], []],
  [[10, 10], []],
  [[11, 11], []],
  [[12, 12], []],
  [[13, 13], []],
  [[10, 13], [10, 13]],
]
match_kind = "all"
search_kind = "overlapping"

[[tests]]
name = "start-end-rep-leftmost-first"
regex = '(^$)*'
haystack = "abc"
matches = [
  [[0, 0], []],
]
match_kind = "leftmost-first"
search_kind = "overlapping"

[[tests]]
name = "start-end-rep-all"
regex = '(^$)*'
haystack = "abc"
matches = [
  [[0, 0], []],
  [[1, 1], []],
  [[2, 2], []],
  [[3, 3], []],
]
match_kind = "all"
search_kind = "overlapping"

[[tests]]
name = "alt-leftmost-first-100"
regex = 'abc|a'
haystack = "zzabcazzaabc"
matches = [[2, 3], [2, 5]]
match_kind = "leftmost-first"
search_kind = "overlapping"

[[tests]]
name = "alt-all-100"
regex = 'abc|a'
haystack = "zzabcazzaabc"
matches = [[2, 3], [2, 5], [5, 6], [8, 9], [9, 10], [9, 12]]
match_kind = "all"
search_kind = "overlapping"

[[tests]]
name = "empty-000"
regex = ""
haystack = "abc"
matches = [[0, 0], [1, 1], [2, 2], [3, 3]]
match_kind = "all"
search_kind = "overlapping"

[[tests]]
name = "empty-alt-000"
regex = "|b"
haystack = "abc"
matches = [[0, 0], [1, 1], [2, 2], [1, 2], [3, 3]]
match_kind = "all"
search_kind = "overlapping"

[[tests]]
name = "empty-alt-010"
regex = "b|"
haystack = "abc"
matches = [[0, 0], [1, 1], [2, 2], [1, 2], [3, 3]]
match_kind = "all"
search_kind = "overlapping"

[[tests]]
# See: https://github.com/rust-lang/regex/issues/484
name = "iter1-bytes"
regex = ''
haystack = "☃"
matches = [[0, 0], [1, 1], [2, 2], [3, 3]]
utf8 = false
match_kind = "all"
search_kind = "overlapping"

[[tests]]
# See: https://github.com/rust-lang/regex/issues/484
name = "iter1-utf8"
regex = ''
haystack = "☃"
matches = [[0, 0], [3, 3]]
match_kind = "all"
search_kind = "overlapping"

[[tests]]
name = "iter1-incomplete-utf8"
regex = ''
haystack = '\xE2\x98'  # incomplete snowman
matches = [[0, 0], [2, 2]]
match_kind = "all"
search_kind = "overlapping"
unescape = true

[[tests]]
name = "scratch"
regexes = ['sam', 'samwise']
haystack = "samwise"
matches = [
  { id = 0, span = [0, 3] },
]
match_kind = "leftmost-first"
search_kind = "overlapping"
